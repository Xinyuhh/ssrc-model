import cenpy
import pandas as pd

import censusdata   # pip install censusdata
import pandas as pd
import os

# Set your Census API key as an environment variable
os.environ["CENSUS_API_KEY"] = "5b498d1ae7076f392073d199334c5cc03aba91bc"

print("Running ... ")

# Create geography objects for New York City, boroughs, and PUMAs
nyc_city = "140|16000US3651000"
nyc_boro = "140|31000US35620,31000US36047,31000US36061,31000US36081,31000US36085"
nyc_puma = "140|79500US3603701,79500US3603702,79500US3603703,79500US3603704,79500US3603705,79500US3603706,79500US3603707,79500US3603708,79500US3603709,79500US3603710,79500US3604001,79500US3604002,79500US3604003,79500US3604004,79500US3604005,79500US3604006,79500US3604007,79500US3604008,79500US3604009,79500US3604010,79500US3604011,79500US3604012,79500US3604013,79500US3604014,79500US3604015,79500US3604016,79500US3604017,79500US3604018,79500US3603801,79500US3603802,79500US3603803,79500US3603804,79500US3603805,79500US3603806,79500US3603807,79500US3603808,79500US3603809,79500US3603810,79500US3604101,79500US3604102,79500US3604103,79500US3604104,79500US3604105,79500US3604106,79500US3604107,79500US3604108,79500US3604109,79500US3604110,79500US3604111,79500US3604112,79500US3604113,79500US3604114,79500US3603901,79500US3603902,79500US3603903"

# Fetch population data
population_df = censusdata.download(src="acs5", year=2021, geo=censusdata.censusgeo([(nyc_city, "New York city")]), var=['B01003_001E'])
print(population_df)